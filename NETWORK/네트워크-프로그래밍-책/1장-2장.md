### OSI 7계층 vs TCP/IP 4계층

OSI 7계층은 네트워크 소프트웨어와 프로토콜이 레이어 계층을 나눠서 설계되어야 함을 제시하는 이론적인 모델이라고 한다면, TCP/IP는 실제로 동작하는 구현체에 가깝다. OSI는 주로 학술적인 목적으로 사용되고, TCP/IP는 실제 네트워크에서 사용된다. (OSI 7계층은 이론적 + 학술적인 목적, TCP/IP는 실제로 동작하는 구현체)

https://www.quora.com/unanswered/Whats-the-major-difference-between-an-OSI-model-and-a-TCP-IP-model

### 계층별 데이터 이름

1. 애플리케이션 - 메시지
2. 프레젠테이션 - 메시지
3. 세션 - 메시지
4. 전송 - 세그먼트 또는 데이터그램
5. 네트워크 - 패킷
6. 데이터링크 - 프레임
7. 물리 - 비트

### OSI 7계층 모델의 계층별 기능

1~4 계층은 Data Flow Layer 혹은 Lower Layer 라고 부름. 데이터를 상대방에게 잘 전달하는 역할

5~7 계층은 Application Layer 혹은 Upper Layer 라고 부름. 데이터를 잘 만드는 역할

1. **물리 계층**
- 호스트를 전송 매체와 연결하기 위한 인터페이스 규칙과 전송 매체 특성
    - 호스트 = 노드 = 컴퓨터, 서버, 스마트폰 등
- 주소 개념 없음
- 장비는 허브, 커넥터, 케이블, 리피터, 트랜시버(컴퓨터 LAN 카드와 케이블 연결), 탭(네트워크 모니터링 및 패킷 분석을 위해 전기 신호를 다른 장비로 복사)

2. **데이터 링크 계층**
- 직렬화(Serialization). 전기 신호를 데이터 형태로 변환 혹은 데이터를 전기 신호로 변환
- 에러 제어. 물리적 전송 오류, 데이터 분실 혹은 깨짐
- 흐름 제어. 상대방이 데이터를 받을 수 있는지 확인
- 주소 정보 존재. 출발지와 도착지를 구분
- 장비는 인터페이스 카드(혹은 Network Interface Card, Network 카드, LAN 카드, Ethernet 카드), 스위치, 브릿지 존재

- NIC 동작 과정
    - 전기 신호를 데이터 형태로 변환
    - 출발지 MAC 주소와 목적지 MAC 주소 확인
    - 네트워크 인터페이스 카드 MAC 주소 확인
    - MAC 주소가 동일하면(혹은 브로드캐스트) 데이터를 처리. 아니면 폐기
    
- 허브와 스위치 차이
    1. 하나의 포트로 전기신호 들어오면, 나머지 포트들로 전기신호 전달.
        송수신 동시에 불가. 한쪽 방향으로만 동작
        [전달받지 않아도 되는 포트라면 그냥 폐기.](https://www.youtube.com/watch?v=66lp--WeGpc)
        
    2. 스위치는 허브와 **내부 동작 방식**만 다르기 때문에 **스위칭 허브**라고 부르기도 함
        MAC 주소 이해가 가능하므로 목적지로 포워딩 포워딩. 스위치처럼 나머지 포트들로 전기신호를 모두 전송할 필요가 없음.
        송수신 동시에 가능 → 이더넷 네트워크 발전의 핵심(통신에 필요한 포트만 사용하므로 효율적)
        L2 스위치는 데이터 링크 계층, L3는 네트워크 계층, L4는 전송계층, L7는 로그 확인, 보안 장비로 사용
        
- 스위치와 브리지 차이
    - 스위치는 처리 방식이 하드웨어적, 브리지는 소프트웨어적
    - 스위치는 포트들의 속도가 다름. 브리지는 포트들의 속도가 동일
    - 스위치는 Cut-thorugh, Store and Forward 방식 둘 다 지원. 브리지는 Store and Forward 방식만 지원
        - Store and Forward는 전체 프레임을 수신. 에러 검사 후 스위칭 ⇒ 안정성이 높음
        - Cut-through는 전체 프레임을 수신X. 에러 검사 없이 스위칭 ⇒ 지연시간이 짧고 전송속도가 빠름
        
3. **네트워크 계층**
- 호스트에서 호스트로의 전달
    - 호스트란 네트워크에 연결된 장비로, 컴퓨터, 노트북, 데스크톱, 서버 등을 의미
- 빠르게 전달하는 것을 목적으로 하는 계층으로 IP 패킷 최적의 **경로 설정**. 말 그대로 경로를 설정함.
- 장비는 라우터, L3 스위치(라우터와 유사한 역할)

4. **전송 계층**
- 프로세스에서 프로세스로의 전달
- 포트 번호로 애플리케이션을 구분
- 데이터를 교환하는 최종 주체는 호스트 시스템이 아닌, 호스트 내부에서 실행되는 네트워크 프로세스
    - 계층 4까지의 기능은 시스템 콜 형태로 제공. 5~7의 기능은 사용자 프로그램으로 작성
- 패킷 네트워크는 데이터를 분할해 패킷에 실어보냄. 중간에 패킷이 유실되거나 순서가 바뀌는 경우 존재하는데 전송 계층은 이를 바로잡아 주는 역할.
    - 패킷은 시퀀스 번호(보내는 순서를 명시), ACK 번호(받는 순서를 명시) 포함
    - 포트 번호(애플리케이션 구분) 존재

![[Pasted image 20250707234206.png]]
    
- (1) 출발지에서 시퀀스 0번 보냄 (2) 수신측에서 잘 받으면 다음 받을 ACK 1번 보냄. 처음 보내는 것이므로 SEQ 0을 보냄 (3) 송신측은 1번을 요청받았으므로 SEQ 1을 보내고, 상대방의 SEQ 0을 잘 받았으므로 ACK 1을 보냄.
- 장비는 L4 스위치(로드밸런서)와 방화벽
- 로드밸런서 특징
    - 4계층 포트 주소 확인 및 IP 주소 변경(Network Address Translation)
    - 웹 서버 증설 후 웹 서버 앞에 로드밸런서 배치. 로드밸런서는 패킷의 목적지 IP 주소를 변경해 웹 서버로 전송. 웹 서버에 문제가 발생하더라도 빠르게 해결.

5. **세션 계층**
- 데이터의 논리적 연결을 담당. 데이터 전송을 위한 연결 경로를 만들고, 이 경로가 안정적으로 유지되는지 확인하고, 필요하면 다시 연결. 데이터를 주고 받을 수 있는 상태인지 확인
- 에러로 중단된 통신에 대한 에러 복구와 재전송
- 세션 설정, 유지, 종료 등 담당

6. **표현 계층**
- 표현 방식이 다른 애플리케이션간의 통신을 돕기 위해 하나의 통일된 구문 형식으로 변환
- 데이터 압축 및 암호화

7. **응용 계층**
- 사용자와 네트워크간의 인터페이스 제공 (대표적인 예로 웹브라우저)
- 애플리케이션을 통해 네트워크 서비스를 이용할 수 있도록 네트워크 통신 기능을 제공하는 가장 핵심 계층
- 7계층 로드 밸런서는 ADC(Application Delivery Controller), 게이트 웨이(L7 스위치)

※ OSI 7계층과 TCP/IP 계층
- OSI 7 계층은 장비 개발, 통신 자체에 대한 표준, De jure
- TCP/IP 계층은 실무 통신 구현, De facto

※ 공유기
공유기는 2계층 스위치, 3계층 라우터, 4계층 NAT와 간단한 방화벽 기능을 한곳에 모아놓은 장비

### 인캡슐레이션과 디캡슐레이션

- 인캡슐레이션은 상위 계층에서 하위 계층으로 데이터를 보냄
- 디캡슐레이션은 하위 계층에서 상위 계층으로 데이터를 보냄
- 데이터 전송은 크게 두 가지 과정 거침
    - 인캡슐레이션, 디캡슐레이션 과정을 통해서 데이터가 전송되는 과정
    - 각 계층 헤더를 이용해 송신자 계층과 수신자 계층간 논리적 통신
    - 요청시 출발지, 도착지 주소와 응답시 출발지, 도착지 주소는 반대

[IP 주소란?](https://inpa.tistory.com/entry/WEB-%F0%9F%8C%90-IP-%EA%B8%B0%EC%B4%88-%EC%82%AC%EC%84%A4IP-%EA%B3%B5%EC%9D%B8IP-NAT-%EA%B0%9C%EB%85%90-%EC%A0%95%EB%A7%90-%EC%89%BD%EA%B2%8C-%EC%A0%95%EB%A6%AC)

[공인 IP | 사설 IP | Network Translation](https://inpa.tistory.com/entry/WEB-%F0%9F%8C%90-IP-%EA%B8%B0%EC%B4%88-%EC%82%AC%EC%84%A4IP-%EA%B3%B5%EC%9D%B8IP-NAT-%EA%B0%9C%EB%85%90-%EC%A0%95%EB%A7%90-%EC%89%BD%EA%B2%8C-%EC%A0%95%EB%A6%AC)

[호스트의 가장 왼쪽을 서브넷 구분 비트로 하여 쪼개서 나눠준다.](https://inpa.tistory.com/entry/WEB-IP-%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%84%9C%EB%B8%8C%EB%84%B7-%EB%A7%88%EC%8A%A4%ED%81%AC-%EC%84%9C%EB%B8%8C%EB%84%B7%ED%8C%85-%EC%B4%9D%EC%A0%95%EB%A6%AC#%EC%84%9C%EB%B8%8C%EB%84%B7_/_%EC%84%9C%EB%B8%8C%EB%84%B7_%EB%A7%88%EC%8A%A4%ED%81%AC_/_%EC%84%9C%EB%B8%8C%EB%84%A4%ED%8C%85_%EC%B4%9D%EC%A0%95%EB%A6%AC)

참고로 192.168은 RFC에서 정한 사설 IP 주소 범위임.

### 패킷 네트워크

- 패킷 네트워크는 패킷 기반. 데이터를 분할해 패킷에 실어보냄. 이를 통해서 하나의 통신이 회선 전체 점유 못함.

### 헤더에 반드시 있어야 하는 정보

1. 현재 계층에서 정의하는 정보
    - 4계층은 SEQ 번호, ACK 번호
    - 3계층은 출발지, 도착지 IP 주소
    - 2계층은 출발지, 도착지 MAC 주소
2. 상위 프로토콜 지시자
    - 4계층 **포트 번호(출발지와 목적지 구분)**는 상위 계층이 FTP인지, 텔넷인지 판단
        - 잘 알려진 포트(웰 노운 포트로는 HTTP TCP 80, HTTPS TCP 443, SMTP TCP 25등이 있음)
        - 웰 노운 포트로는 1023번 이하의 포트 번호 사용
    - 3계층 **프로토콜 번호**는 상위 계층이 TCP인지, UDP인지 판단
    - 2계층 **이더 타입**은 상위 계층이 IP인지, ARP인지, ICMP인지 판단
    
### MSS(Maximum Segment Size) & MTU(Maximum Transmission Unit)

- MSS는 전송 프로토콜에서 수용하는 데이터의 최대 크기
- MTU는 데이터링크 프로토콜에서 수용하는 데이터의 최대 크기. 1500B
    - TCP와 IP의 표준 헤더 크기 20Byte
    - 이때 MTU는 1460Byte

![[Pasted image 20250707234143.png]]
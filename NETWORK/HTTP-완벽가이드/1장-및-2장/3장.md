### HTTP 메시지란

- HTTP 애플리케이션 간에 주고받는 데이터의 블록
    
    요청 메시지, 응답 메시지로 구분
    

### HTTP 메시지의 흐름

- 클라이언트, 서버, 프록시 사이를 흐름
- 인바운드, 아웃바운드, 업스트림, 다운스트림은 메시지의 방향 표현
1. 인바운드는 사용자에서 서버
2. 아웃바운드는 서버에서 사용자
3. 프락시 1은 프락시 3의 업스트림
4. 프락시 3은 프락시 1의 다운스트림
5. 모든 데이터는 다운스트림으로 흐름

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/75de5dd3-46a5-41a6-8f0c-f50a64ee797b/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c9a63449-62b1-4bfe-8e29-c75cb039d125/Untitled.png)

### HTTP 메시지 구성

- 시작줄, 헤더, 엔터티 본문으로 구성
1. 시작줄
- 요청은 <메서드><요청URL><버전>
- 응답은 <버전><상태코드><사유구절>

| 메서드     | 설명                                     | 본문  | 안전한 메서드 |
| ------- | -------------------------------------- | --- | ------- |
| GET     | 리소스 조회                                 | x   | o       |
| POST    | 리소스 등록                                 | o   | x       |
| PUT     | 리소스 대체, 없으면 생성                         | o   | x       |
| PATCH   | 리소스 일부 변경                              | o   | x       |
| DELETE  | 리소스 삭제                                 | x   | x       |
| TRACE   | 서버에서부터 루프백 테스트, 보낸 데이터가 얻기했는지 수정했는지 확인 | x   | x       |
| HEAD    | 리소스의 상태줄과 헤더만 조회                       | x   | o       |
| OPTIONS | 웹 서버에서 지원하는 요청방식 확인                    | x   | x       |


    ※ 루프백은 원래의 장치로 돌아가는 것
    
    ※ 안전한 메서드는 HTTP의 결과로 서버에 어떤 작용도 없음을 의미. 구매 버튼을 눌렀을 때, POST 요청이 발생하고, 신용카드로 대금이 청구되는 경우는 ‘작용’이 존재한다.
    
    안전한 메서드가 서버에 작용을 유발하지 않는다는 보장은 없다(개발자에게 달려있음). 안전한 메서드의 목적은, 안전하지 않은 메서드가 사용될 때 그 사실을 알려주는 HTTP 애플리케이션을 만들 수 있도록 하는 것에 있다. 가령 앞선 예처럼 신용카드가 결제되는 상황에 대한 알림 등을 의미한다.
    
2. 헤더
- 요청과 응답 메시지에 추가 정보
- 이름:값 쌍의 리스트
- 없는 경우, CRLF만 존재

3. 엔터티 본문 
- 텍스트, 이진 데이터 포함
- 없어도 됨
    
- 헤더와 바디를 구분하기 위해 CRLF 사용
    - carriage return은 커서를 맨 앞으로,
    - line feed는 커서를 한 줄 아래로,
    - EOL(End-Of-Line)은 CRLF와 동일.
    - 윈도우: CRLF / 맥북 & 리눅스:  LF

### HTTP 버전

- HTTP 버전 1.1과 대화하는 HTTP 버전 1.2는, HTTP 버전 1.2의 기능을 사용할 수 없음.
- 버전 번호는 분리된 숫자. 2.22는 2.3보다 크다. (22 > 3)

### 헤더 분류

1. 일반 헤더
    1. 일반 헤더: connection, date 등
    2. 캐시 헤더: cache-control, pragma
2. 요청 헤더
    1. 요청 헤더: User-Agent, Client-ip
    2. Accept 관련 헤더: Accept
    3. 조건부 요청 헤더: if-Modified-Since, if-Unmodified-Since, if-Match
    4. 요청 보안 헤더: Authrization, Cookie
    5. 프락시 요청 헤더
3. 응답 헤더
    1. 응답 헤더: Warning, Server
    2. 협상 헤더
    3. 보안 헤더
4. 엔터티 헤더   
    1. 엔터티 헤더 
    2. 콘텐츠 헤더: Content-Length, Content-Type
    3. 엔터티 캐싱 헤더: Etag, Expired, Last-Modified
5. 확장 헤더

6. 일반 헤더
- 요청과 응답 양쪽에 모두 나타남

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/287aed03-e221-4310-b72a-8c542bf6ee30/Untitled.png)

- HTTP 1.0부터는 캐시 헤더 도입

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/661210e6-1a80-43da-a000-76134a04d36f/Untitled.png)

1. 요청 헤더

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0f622a52-182a-40b5-a5d5-44f2dfcab0b7/Untitled.png)

- Accept 관련 헤더

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e227feac-f2bc-45fd-9cc6-2d45fb79e3e6/Untitled.png)

- 조건부 요청 헤더

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/87399be2-886f-4cbb-8ed5-3ac970d00cb2/Untitled.png)

- 요청 보안 헤더

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a8671388-36fc-4297-9efe-ca0541e42e37/Untitled.png)

- 프락시 요청 헤더

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a4e4d60d-4970-4f72-84d7-e1f7023e5ae8/Untitled.png)

1. 응답 헤더
- Server: Tiki-Hut/1.0 (클라이언트에게 Tiki-Hut 서버 1.0버전과 대화하고 있음을 알려줌)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6cba2593-157c-4982-b8d5-41f32d214067/Untitled.png)

- 협상 헤더
    - 서버에 프랑스어와 독일어로 번역한 HTML 문서가 있는 경우와 같이, 여러 가지 표현이 가능한 상황이라면, HTTP/1.1은 서버와 클라이언트가 어떤 표현을 택할 것인가에 대한 협상을 할 수 있도록 지원. 17장 ‘협상’에서 추가 설명

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/df022655-7ea4-4a94-aa75-dd8d90cb2b37/Untitled.png)

- 응답 보안 헤더

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2a52ea65-8160-43a7-bbe3-59c6760efd38/Untitled.png)

1. Entity 헤더
- 엔터티 본문의 정보에 대한 헤더
- 요청과 응답 양쪽에 모두 나타남
- 일반적으로 자신이 다루고 있는 것이 무엇인지 말해준다.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2a69fcee-d4ae-4bb6-ae30-49e169aa9656/Untitled.png)

- 콘텐츠 헤더

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3aecfff0-04dc-4a86-b299-da8e7190a1d7/Untitled.png)

- 엔터티 캐싱 헤더

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b4bd9b24-098b-459b-92a4-9567a1db3fe1/Untitled.png)

1. 확장 헤더
- 명세에 정의되지 않은 헤더
- HTTP 프로그램은 의미를 몰라도 전달해야 함

### 헤더를 여러 줄로 나누기

- 헤더 줄을 쪼개려면 최소 하나의 스페이스 혹은 탭 필요

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f52cd3b3-b114-4f70-8c94-357af36d505a/Untitled.png)

### 상태 코드

| 번호 범위 | 의미 |
| --- | --- |
| 100 ~ | 정보 |
| 200 ~ | 성공 |
| 300 ~  | 리다이렉트 |
| 400 ~  | 클라이언트 에러 |
| 500 ~ 599 | 서버 에러 |

### 100 ~ 199

100번대는 **요청이 받아들여졌는지**를 알려주는 응답입니다.

- 100 Continue
    
    엔터티 본문을 전송하기 전에, 서버가 받을 것인지 확인하며, **서버가 받을 수 없는 큰 엔터티를 보내지 않으려는 목적**입니다. Expect 헤더에 100-continue를 담아서 보냅니다.
    

### 200 ~ 299

- 200 OK
    - 요청 정상 처리
- 201 Created
    - 리소스가 성공적으로 생성됨 (POST, PUT)
- 202 Accepted
    - 요청은 받아들여졌으나, 아직 처리되지 않음 
- 204 No Content
	- 요청은 성공했지만 응답 본문이 없음

### 300 ~ 399

요청을 처리하기 위해서 **추가적인 작업이 필요함을 응답**합니다. 두 번째 요청이 GET 또는 HEAD인 경우, 유저의 행위 없이, 유저 에이전트가 추가적인 작업을 알아서 처리합니다.

- 300 Multiple Choices
    
    클라이언트가 동시에 여러 리소스를 가리키는 URL을 요청하는 경우, 리소스의 목록과 함께 반환합니다.
    
- 301 Moved Permanently
    
    요청한 URL이 옮겨졌을 때 사용합니다. Location 헤더에 리소스 위치를 포함합니다.
    

### 400 ~ 499

**에러가 사용자에 의해서 발생했음**을 알려줍니다. 

- 400 BadRequest
    - 잘못된 요청
    
- 401 Unauthorized
    - 인증 요구
    
- 403 Forbidden
    - 요청이 서버에 의해 거절되었으며, 요청이 서버에 의해 거절된 이유를 숨기고 싶을때 사용합니다’
    
- 404 Not Found

### 500 ~ 599

서버가 **요청 수행을 실패했음**을 알려줍니다.

- 500 Internal Server Error
    - 서버가 예측하지 못한 에러

- 501 Not Implemeneted
    - 서버의 능력을 넘는 요청을 했을 때
    
- 502 Bad Gateway
    - 자신의 부모 게이트웨이 접근이 불가

https://en.wikipedia.org/wiki/List_of_HTTP_status_codes